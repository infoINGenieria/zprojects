/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * FrancosLicenciasDialog.java
 *
 * Created on 20/09/2014, 11:58:02
 */
package zilleprojects.form;

import DAO.AbstractDAO;
import DAO.FrancosLicenciasDAO;
import Modelo.EntidadAbstracta;
import Modelo.tablemodel.FrancosLicenciasTableModel;
import Modelo.tablemodel.ZilleAbstractTableModel;
import Utils.FrancosLicenciasCellRenderer;
import ViewModel.ItemFrancoLicencia;
import java.awt.Dimension;
import java.awt.GraphicsEnvironment;
import java.awt.Rectangle;
import javax.swing.JButton;
import javax.swing.JDialog;
import org.jdesktop.application.Action;
import org.jdesktop.application.Task;

/**
 *
 * @author m4tuu
 */
public class FrancosLicenciasDialog extends ZilleDialog {
    
    /** Creates new form FrancosLicenciasDialog */
    public FrancosLicenciasDialog(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        getTabla().setDefaultRenderer(Object.class, new FrancosLicenciasCellRenderer());
        Info("Cargando informaci√≥n. Espere por favor...");
        SetButtonExtra(jBtnExportar);
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jBtnExportar = new javax.swing.JButton();

        javax.swing.ActionMap actionMap = org.jdesktop.application.Application.getInstance(zilleprojects.ZilleProjectsApp.class).getContext().getActionMap(FrancosLicenciasDialog.class, this);
        jBtnExportar.setAction(actionMap.get("generarXls")); // NOI18N
        org.jdesktop.application.ResourceMap resourceMap = org.jdesktop.application.Application.getInstance(zilleprojects.ZilleProjectsApp.class).getContext().getResourceMap(FrancosLicenciasDialog.class);
        jBtnExportar.setIcon(resourceMap.getIcon("jBtnExportar.icon")); // NOI18N
        jBtnExportar.setText(resourceMap.getString("jBtnExportar.text")); // NOI18N
        jBtnExportar.setMaximumSize(new java.awt.Dimension(146, 34));
        jBtnExportar.setMinimumSize(new java.awt.Dimension(146, 34));
        jBtnExportar.setName("jBtnExportar"); // NOI18N
        jBtnExportar.setPreferredSize(new java.awt.Dimension(146, 34));

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setName("Form"); // NOI18N

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jBtnExportar;
    // End of variables declaration//GEN-END:variables

    
    
    @Override
    protected String[] getConfigColumn() {
        String[] conf = new String[] {"0:240"};
        return conf;
    }
    
    @Override
    protected String getTablaName() {
        return "operarios";
    }

    @Override
    protected String getNombreEntidad() {
        return "Francos y Vacaciones";
    }
    
    @Override
    public boolean isNuevoEnabled() {
        return false;
    }
    
    @Override
    public boolean isModificarEnabled() {
        return false;
    }
    
    @Override
    public boolean isEliminarEnabled() {
        return false;
    }

    @Override
    protected void limpiarEntidad() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    protected AbstractDAO getDao() {
        return new FrancosLicenciasDAO();
    }

    @Override
    protected EntidadAbstracta getEntidadAbstracta() {
        return items;
    }

    @Override
    protected void setEntidadAbstracta(EntidadAbstracta ea) {
        items = (ItemFrancoLicencia) ea;
    }

    @Override
    protected ZilleAbstractTableModel getTableModel() {
        return tableModel;
    }

    @Override
    protected ZilleAbstractTableModel setNewTableModel() {
        return new FrancosLicenciasTableModel();
    }

    @Override
    protected void setTableModel(ZilleAbstractTableModel ea) {
        tableModel = (FrancosLicenciasTableModel) ea;
    }

    @Override
    protected void setTitulo() {
        setTitle( "Francos y Licencias anuales");
    }

    @Override
    protected Dimension getSizeMainWindow() {
        Rectangle rec = GraphicsEnvironment.getLocalGraphicsEnvironment().getMaximumWindowBounds();
        return new Dimension(rec.getSize().width, 700);
    }

    @Override
    protected JDialog getAMEntidad() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    protected JButton getBtnAceptarEntidadEdit() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    protected JButton getBtnCancelarEntidadEdit() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    protected void CargarEntidadAlEditar(EntidadAbstracta entidad) {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    protected boolean GuardarEntidadAlEditar() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Override
    protected Dimension getSizeDialogEdit() {
        throw new UnsupportedOperationException("Not supported yet.");
    }

    @Action
    public Task generarXls() {
        return new GenerarXlsTask(org.jdesktop.application.Application.getInstance(zilleprojects.ZilleProjectsApp.class));
    }

    private class GenerarXlsTask extends org.jdesktop.application.Task<Object, Void> {
        GenerarXlsTask(org.jdesktop.application.Application app) {
            // Runs on the EDT.  Copy GUI state that
            // doInBackground() depends on from parameters
            // to GenerarXlsTask fields, here.
            super(app);
        }
        @Override protected Object doInBackground() {
            // Your Task's code here.  This method runs
            // on a background thread, so don't reference
            // the Swing GUI from here.
            
            FrancosLicenciasDAO dao = new FrancosLicenciasDAO();
            dao.ReporteXlsResumenFrancosLicencias(getTableModel().getData());
            return null;  // return your result
        }
        @Override protected void succeeded(Object result) {
            // Runs on the EDT.  Update the GUI based on
            // the result computed by doInBackground().
        }
    }


    
    ItemFrancoLicencia items = new ItemFrancoLicencia();
    FrancosLicenciasTableModel tableModel = new FrancosLicenciasTableModel();
}
